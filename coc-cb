
# Codebook: Country-Country-Industry Aggregated Data


This document describes the structure and content of the country-country-industry aggregated CSV files generated by the NPI/NPF estimation system.


## Data Coverage


**Years**: 2016-2023 (8 years)
**Geographic Scope**: Global, using ISO3 country codes
**Industry Classification**: NAICS 2-digit level (20 major industry categories)


## Data Files


The following CSV files contain aggregated NPI (Network Power Index) and NPF (Network Power Flow) estimates at the country-country-industry level:


- `/all/npi_country_country-industry_consolidated_all.csv` - NPI estimates using all ownership networks
- `/all/npf_country_country-industry_consolidated_all.csv` - NPF estimates using all ownership networks
- `/gcc/npi_country_country-industry_consolidated_gcc.csv` - NPI estimates using giant connected component networks only
- `/gcc/npf_country_country-industry_consolidated_gcc.csv` - NPF estimates using giant connected component networks only


## Data Generation Process


The data is generated through a three-stage pipeline:


1. **Data Loading**: NPI/NPF estimation results and financial data (ORBIS)
2. **Database Integration**: Data is joined with entity, industry classification, and financial information
3. **Aggregation**: Results are aggregated by source country, destination country, and destination industry (NAICS 2-digit level)
4. **ISO3 Conversion**: Country names are converted to ISO3 codes for standardization
5. **Final Aggregation**: Data is re-aggregated by ISO3 country codes and NAICS categories


## Column Descriptions


### Core Identifier Columns


| Column | Type | Description |
|--------|------|-------------|
| `year` | Integer | The year of the ownership network data (2016-2023) |
| `from_country_iso3` | String | ISO3 country code of the source/controlling country |
| `to_country_iso3` | String | ISO3 country code of the destination/controlled country |
| `to_naics_large_category_code` | String | NAICS 2-digit industry code of destination entities (see NAICS table below) |
| `to_naics_large_category_label` | String | NAICS industry label corresponding to the 2-digit code |


### Aggregated Metrics


| Column | Type | Description |
|--------|------|-------------|
| `from_count` | Integer | Count of ownership relationships from source country to destination country-industry |
| `total_npi` / `total_npf` | Float | Sum of NPI/NPF values for all relationships in this country-industry pair |
| `from_count_revenue_not_null` | Integer | Count of relationships where destination entity has non-null revenue data |
| `total_npi_revenue_weighted` / `total_npf_revenue_weighted` | Float | Revenue-weighted sum of NPI/NPF values |
| `from_count_employee_not_null` | Integer | Count of relationships where destination entity has non-null employee data |
| `total_npi_employee_weighted` / `total_npf_employee_weighted` | Float | Employee-weighted sum of NPI/NPF values |


## Data Characteristics and Limitations


### Coverage Limitations
- **Incomplete Time Series**: Not all country-country-industry combinations have observations for every year
- **Missing Industry Classifications**: Rows with null `to_naics_large_category_code` and `to_naics_large_category_label` indicate entities where NAICS industry classification could not be determined
- **Variable Entity Coverage**: The number of entities and relationships varies significantly across countries and years


### Data Quality Notes
- **Revenue/Employee Weighting**: Weighted metrics are only calculated for entities with available financial data
- **Self-References Excluded**: Domestic ownership (same source and destination country) relationships are excluded from the aggregation


## Appendix
### NAICS Industry Classification Table


The `to_naics_large_category_code` and `to_naics_large_category_label` columns use the following NAICS 2-digit industry categories:


| Code | Industry Label |
|------|----------------|
| 11 | Agriculture, Forestry, Fishing and Hunting |
| 21 | Mining, Quarrying, and Oil and Gas Extraction |
| 22 | Utilities |
| 23 | Construction |
| 31-33 | Manufacturing |
| 42 | Wholesale Trade |
| 44-45 | Retail Trade |
| 48-49 | Transportation and Warehousing |
| 51 | Information |
| 52 | Finance and Insurance |
| 53 | Real Estate and Rental and Leasing |
| 54 | Professional, Scientific, and Technical Services |
| 55 | Management of Companies and Enterprises |
| 56 | Administrative and Support and Waste Management and Remediation Services |
| 61 | Educational Services |
| 62 | Health Care and Social Assistance |
| 71 | Arts, Entertainment, and Recreation |
| 72 | Accommodation and Food Services |
| 81 | Other Services (except Public Administration) |
| 92 | Public Administration |


*Note: Manufacturing (31-33), Retail Trade (44-45), and Transportation and Warehousing (48-49) represent combined NAICS sectors that are grouped together in this classification system.*


### Original Data Sources


The aggregated data combines information from multiple Orbis datasets:
- **Ownership Networks**: Corporate ownership relationships
- **Entity Information**: Company names, countries, and identifiers
- **Financial Data**: Revenue and employee counts
- **Industry Classifications**: NAICS industry codes from Firmographics data


### Usage Recommendations


1. **Time Series Analysis**: Check for data availability across years before conducting longitudinal analysis
2. **Industry Analysis**: Be aware that entities with missing NAICS classifications represent a significant portion of the data
3. **Weighting**: Use revenue or employee-weighted metrics when analyzing economic significance rather than simple relationship counts
4. **Network Types**: Compare results between 'all' and 'gcc' (giant connected component) networks to understand the impact of network topology on estimates
